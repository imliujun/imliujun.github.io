<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="å¾®ä¿¡å…¬ä¼—å·ï¼šå¤§è„‘å¥½é¥¿"><title>Lottie -- è½»æ¾å®ç°åŠ¨æ€åŠ è½½ç›´æ’­ç¤¼ç‰©åŠ¨ç”» | å¤§è„‘å¥½é¥¿</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="/css/donate.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-71377766-1','auto');ga('send','pageview');</script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Lottie -- è½»æ¾å®ç°åŠ¨æ€åŠ è½½ç›´æ’­ç¤¼ç‰©åŠ¨ç”»</h1><a id="logo" href="/.">å¤§è„‘å¥½é¥¿</a><p class="description">è¡¥å……å¤§è„‘è¥å…»</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> é¦–é¡µ</i></a><a href="/archives/"><i class="fa fa-archive"> å½’æ¡£</i></a><a href="/about/"><i class="fa fa-user"> å…³äº</i></a><a href="/atom.xml"><i class="fa fa-rss"> è®¢é˜…</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Lottie -- è½»æ¾å®ç°åŠ¨æ€åŠ è½½ç›´æ’­ç¤¼ç‰©åŠ¨ç”»</h1><div class="post-meta">2017-04-25<span> | </span><span class="category"><a href="/categories/Android/">Android</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> é˜…è¯»</span></span></div><a href="/Lottieåº“å®ç°ç›´æ’­ç¤¼ç‰©åŠ¨ç”».html#SOHUCS" class="ds-thread-count"><span id="changyan_count_unit" style="font-size: 15px; color: #6E7173;">0</span><span> æ¡è¯„è®º</span></a><script src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js" async></script><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">æ–‡ç« ç›®å½•</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ä½¿ç”¨åœºæ™¯"><span class="toc-number">1.</span> <span class="toc-text">ä½¿ç”¨åœºæ™¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä½¿ç”¨è¯¦è§£"><span class="toc-number">2.</span> <span class="toc-text">ä½¿ç”¨è¯¦è§£</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æºç è§£æ"><span class="toc-number">3.</span> <span class="toc-text">æºç è§£æ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å…¨å±é€‚é…"><span class="toc-number">4.</span> <span class="toc-text">å…¨å±é€‚é…</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ–¹æ¡ˆä¸€"><span class="toc-number">4.1.</span> <span class="toc-text">æ–¹æ¡ˆä¸€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ–¹æ¡ˆäºŒ"><span class="toc-number">4.2.</span> <span class="toc-text">æ–¹æ¡ˆäºŒ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ€»ç»“"><span class="toc-number">5.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></div></div><div class="post-content"><blockquote>
<p>æœ¬æ–‡å·²æˆæƒå¾®ä¿¡å…¬ä¼—å·ï¼šé¸¿æ´‹ï¼ˆhongyangAndroidï¼‰åŸåˆ›é¦–å‘ã€‚</p>
</blockquote>
<p>æœ¬æ–‡ä¸»è¦è®²è§£ <a href="https://github.com/airbnb/lottie-android" target="_blank" rel="external">Lottie</a> åº“åŠ¨æ€åŠ è½½ SD å¡ä¸Šå¸¦å›¾ç‰‡èµ„æºçš„åŠ¨ç”»ï¼Œå¹¶å¯¹å„ç§æœºå‹åšå…¨å±é€‚é…ã€‚</p>
<p>Lottie çš„ä¼˜ç‚¹ï¼š</p>
<ul>
<li><p>è·¨å¹³å°ï¼Œæ”¯æŒ Androidã€iOSã€React Native å¹³å°</p>
</li>
<li><p>æ”¯æŒå®æ—¶æ¸²æŸ“ After Effects åŠ¨ç”»ï¼Œè®© app åŠ è½½åŠ¨ç”»åƒåŠ è½½å›¾ç‰‡ä¸€æ ·ç®€å•ã€‚</p>
</li>
<li><p>èµ„æºåŠ¨æ€ä¸‹è½½ï¼Œå‡å° APP ä½“ç§¯ï¼Œä¸Šçº¿æ–°çš„åŠ¨ç”»æ•ˆæœä¸éœ€è¦å‘ç‰ˆ</p>
</li>
<li><p>æ›´å¤šä¼˜ç‚¹ç­‰ä½ å‘ç°</p>
</li>
</ul>
<h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><ul>
<li><p>åšç›´æ’­è½¯ä»¶è‚¯å®šå°‘ä¸äº†å„ç§ç¤¼ç‰©çš„åŠ¨ç”»æ•ˆæœï¼Œå½“ä¸Šçº¿æ–°çš„ç¤¼ç‰©æ—¶ï¼Œä¸ä»… Androidã€ios å®¢æˆ·ç«¯éœ€è¦å®ç°æ–°çš„åŠ¨ç”»æ•ˆæœï¼Œè¿˜å¾ˆéš¾å…¼å®¹è€ç‰ˆæœ¬ã€‚</p>
</li>
<li><p>å¹³å¸¸è¿‡èŠ‚æ—¥çš„æ—¶å€™ï¼Œå¾ˆå¤š APP éƒ½ä¼šåšå„ç§æ´»åŠ¨ï¼Œä¿®æ”¹å¯åŠ¨é¡µçš„å›¾ç‰‡ï¼Œæ›´æ”¹åº”ç”¨å†…çš„æŒ‰é’®å›¾æ ‡ï¼Œå¦‚æœæ¶‰åŠåˆ°åŠ¨ç”»ï¼Œé‚£ä¹ˆè‚¯å®šéœ€è¦æå‰ä¸€ä¸¤ä¸ªç‰ˆæœ¬å°†èŠ‚æ—¥çš„åŠ¨ç”»å®ç°ä»£ç é¢„åˆ¶åˆ°åº”ç”¨å†…</p>
</li>
<li><p>æ›´å¤šåº”ç”¨åœºæ™¯ç­‰ä½ æ¢ç´¢</p>
</li>
</ul>
<p>ç°åœ¨æœ‰äº† Lottieï¼Œå¯ä»¥è®©è®¾è®¡å¸ˆä½¿ç”¨ After Effects è¿›è¡ŒåŠ¨ç”»è®¾è®¡ï¼Œé€šè¿‡ Bodymovin æ’ä»¶å¯¼å‡º json æ–‡ä»¶ï¼Œå°†åŠ¨ç”»èµ„æºæ‰“åŒ…ä¸Šä¼ åˆ°æœåŠ¡å™¨åï¼Œå®¢æˆ·ç«¯é€šè¿‡åŠ¨æ€ä¸‹è½½èµ„æºæ–‡ä»¶æ¥æ‰§è¡ŒåŠ¨ç”»ã€‚è¿™æ ·ä¸Šçº¿æ–°çš„ç¤¼ç‰©ï¼Œåªéœ€è¦å°†èµ„æºæ–‡ä»¶ä¸Šä¼ ï¼Œå®¢æˆ·ç«¯ä¸éœ€è¦å‘ç‰ˆå®Œå…¨å¯ä»¥æ‰§è¡Œæ–°ç¤¼ç‰©çš„åŠ¨ç”»æ•ˆæœã€‚æµç¨‹å¦‚ä¸‹ï¼š</p>
<img title="æµç¨‹å›¾" src="http://images.imliujun.com/static/images/Lottie/Lottie_9.jpeg">  
<h2 id="ä½¿ç”¨è¯¦è§£"><a href="#ä½¿ç”¨è¯¦è§£" class="headerlink" title="ä½¿ç”¨è¯¦è§£"></a>ä½¿ç”¨è¯¦è§£</h2><p>æœ¬æ–‡å°±ä»¥ç›´æ’­é—´æ’­æ”¾åŠ¨ç”»ä¸ºä¾‹å­æ¥è®²è§£å…·ä½“çš„å®ç°æ–¹æ¡ˆï¼Œå…ˆçœ‹ä¸‹åŠ¨ç”»æ•ˆæœï¼š</p>
<img title="åŠ¨ç”»æ•ˆæœ" src="http://images.imliujun.com/static/images/Lottie/Lottie_1.gif">  
<p>ç›´æ’­è½¯ä»¶çš„å¤§ç¤¼ç‰©ä¸€èˆ¬éƒ½æ˜¯é£æœºã€è·‘è½¦ã€èˆªæ¯ã€èŠ±ç“£é›¨ç­‰ï¼Œè¿™äº›ç‰©å“ä¸æ˜¯ç®€å•çš„çº¿æ¡ã€è‰²å—æ‰€èƒ½ç»˜åˆ¶ï¼Œæ‰€ä»¥ä½¿ç”¨å›¾ç‰‡æ–‡ä»¶æ¥å®ç°åŠ¨ç”»æ•ˆæœã€‚<br>å¯¼å‡ºçš„åŠ¨ç”»èµ„æºåŒ…æ‹¬ä¸€ä¸ª json æ–‡ä»¶å’Œä¸€ç»„å›¾ç‰‡æ–‡ä»¶ï¼š</p>
<img title="èµ„æºæ–‡ä»¶ç›®å½•" src="http://images.imliujun.com/static/images/Lottie/Lottie_2.jpg">
<p>å°†è¿™äº›æ–‡ä»¶æ‰“æˆå‹ç¼©åŒ…ä¸Šä¼ åˆ°åå°ï¼Œå®¢æˆ·ç«¯ä¸‹è½½å‹ç¼©åŒ…è¿›è¡Œè§£å‹ï¼Œä½¿ç”¨ Lottie åŠ è½½æœ¬åœ°èµ„æºæ‰§è¡ŒåŠ¨ç”»ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">File jsonFile = <span class="keyword">new</span> File(giftDir, <span class="string">"79.json"</span>);</div><div class="line">File imagesDir = <span class="keyword">new</span> File(giftDir, <span class="string">"images"</span>);</div><div class="line">FileInputStream fis = <span class="keyword">null</span>;</div><div class="line"><span class="keyword">if</span> (jsonFile.exists()) &#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        fis = <span class="keyword">new</span> FileInputStream(jsonFile);</div><div class="line">    &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</div><div class="line">        e.printStackTrace();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (fis == <span class="keyword">null</span> || !imagesDir.exists()) &#123;</div><div class="line">    showLocalAnimation(gift);</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">final</span> String absolutePath = imagesDir.getAbsolutePath();</div><div class="line"><span class="comment">//æä¾›ä¸€ä¸ªä»£ç†æ¥å£ä» SD å¡è¯»å– images ä¸‹çš„å›¾ç‰‡</span></div><div class="line">mLottieAnimationView.setImageAssetDelegate(<span class="keyword">new</span> ImageAssetDelegate() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> Bitmap <span class="title">fetchBitmap</span><span class="params">(LottieImageAsset asset)</span> </span>&#123;</div><div class="line">        BitmapFactory.Options opts = <span class="keyword">new</span> BitmapFactory.Options();</div><div class="line">        opts.inScaled = <span class="keyword">true</span>;</div><div class="line">        opts.inDensity = <span class="number">160</span>;</div><div class="line">        <span class="keyword">return</span> BitmapFactory.decodeFile(absolutePath + File.separator +</div><div class="line">                asset.getFileName(), opts);</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"><span class="comment">//ä»æ–‡ä»¶æµä¸­åŠ è½½ json æ•°æ®</span></div><div class="line">LottieComposition.Factory.fromInputStream(<span class="keyword">this</span>, fis, <span class="keyword">new</span> OnCompositionLoadedListener() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompositionLoaded</span><span class="params">(LottieComposition composition)</span> </span>&#123;</div><div class="line">        mLottieAnimationView.setVisibility(View.VISIBLE);</div><div class="line">        mLottieAnimationView.setComposition(composition);</div><div class="line">        mLottieAnimationView.playAnimation();</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>å…³é”®çš„ä»£ç å°±æ˜¯è®¾ç½®å›¾ç‰‡èµ„æºä»£ç†ï¼Œå» SD å¡è§£æå›¾ç‰‡æ–‡ä»¶ï¼Œé‚£ä¹ˆæ€ä¹ˆçŸ¥é“è¯¥è§£æå“ªä¸€å¼ å›¾ç‰‡å‘¢ï¼Ÿå’±ä»¬æ¥çœ‹çœ‹ json æ–‡ä»¶é‡Œé¢çš„å†…å®¹ï¼š</p>
<img title="jsonæ–‡ä»¶" src="http://images.imliujun.com/static/images/Lottie/Lottie_7.jpg">  
<p><code>assets</code> å­—æ®µæ˜¯å›¾ç‰‡èµ„æºçš„æ•°ç»„ï¼Œå…·ä½“çš„è§£æçš„æºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="title">LottieImageAsset</span><span class="params">(<span class="keyword">int</span> width, <span class="keyword">int</span> height, String id, String fileName)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.width = width;</div><div class="line">    <span class="keyword">this</span>.height = height;</div><div class="line">    <span class="keyword">this</span>.id = id;</div><div class="line">    <span class="keyword">this</span>.fileName = fileName;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Factory</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Factory</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">static</span> LottieImageAsset <span class="title">newInstance</span><span class="params">(JSONObject imageJson)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> LottieImageAsset(</div><div class="line">                  imageJson.optInt(<span class="string">"w"</span>),     <span class="comment">//width</span></div><div class="line">                  imageJson.optInt(<span class="string">"h"</span>),     <span class="comment">//height</span></div><div class="line">                  imageJson.optString(<span class="string">"id"</span>), <span class="comment">//id</span></div><div class="line">                  imageJson.optString(<span class="string">"p"</span>)   <span class="comment">//fileName</span></div><div class="line">               );</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç›´æ¥æ ¹æ® <code>ImageAssetDelegate</code> ä»£ç†ç±»çš„ <code>fetchBitmap(LottieImageAsset asset)</code> æ–¹æ³•ä¸­çš„ <code>LottieImageAsset</code> å‚æ•°è·å–å½“å‰éœ€è¦è§£æçš„å›¾ç‰‡æ–‡ä»¶åï¼Œå» images æ–‡ä»¶å¤¹ä¸‹é¢è§£æå¯¹åº”çš„æ–‡ä»¶å°±OKå•¦ã€‚</p>
<p>è¿™å‡ è¡Œä»£ç å°±å®ç°äº†ä»SDå¡åŠ¨æ€åŠ è½½åŠ¨ç”»ï¼Œé‚£ä¹ˆè¿™æ ·å°±ç®—å®Œå·¥äº†å—ï¼Ÿçœ‹çœ‹ä¸Šé¢çš„åŠ¨ç”»æ˜¯ä¸æ˜¯æ„Ÿè§‰æœ‰ä»€ä¹ˆåœ°æ–¹ä¸å¯¹åŠ²ï¼Ÿå¥½å§ï¼Œä½œä¸ºä¸€ä¸ª Android è½¯ä»¶å·¥ç¨‹å¸ˆï¼Œä¸€å®šè¦è®°ä½2ä¸ªå­— <strong>é€‚é…</strong> <strong>é€‚é…</strong> <strong>é€‚é…</strong></p>
<h2 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h2><p>åŠ¨ç”»æ˜¯å…¨å±çš„æ•ˆæœï¼Œå°å¹½çµä¹Ÿæ˜¯ä»å±å¹•å¤–é£è¿›æ¥çš„æ²¡æœ‰é—®é¢˜ï¼Œä¸ºä»€ä¹ˆèƒŒæ™¯å›¾ç¦»å±å¹•ä¸¤è¾¹æœ‰ç©ºéš™å‘¢ï¼Ÿ</p>
<img title="æ²¡æœ‰å±å¹•é€‚é…çš„æ•ˆæœ" src="http://images.imliujun.com/static/images/Lottie/Lottie_4.jpg">
<p>å†æ¥çœ‹çœ‹è¿™ä¸ªåŠ¨å›¾ï¼Œ<strong>ä¸ºä»€ä¹ˆéšè—è™šæ‹ŸæŒ‰é”®å°±å…¨å±äº†å‘¢ï¼Ÿ</strong></p>
<img title="éšè—è™šæ‹ŸæŒ‰é”®" src="http://images.imliujun.com/static/images/Lottie/Lottie_5.gif">
<p>å†æ¥çœ‹çœ‹ json æ–‡ä»¶é‡Œé¢çš„å†…å®¹ï¼š</p>
<img title="jsonæ–‡ä»¶" src="http://images.imliujun.com/static/images/Lottie/Lottie_7.jpg">
<p>èƒŒæ™¯å›¾çš„å®½é«˜å’Œç”»å¸ƒçš„å®½é«˜æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆæœ‰è™šæ‹ŸæŒ‰é”®çš„æ—¶å€™èƒŒæ™¯å›¾å°±ä¸å…¨å±å‘¢ï¼ŸåŸå› å…¶å®å¾ˆç®€å•ï¼Œæ¥çœ‹ä¸€ä¸‹ Lottie æ˜¯æ€ä¹ˆè§£æ json æ•°æ®ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">static</span> LottieComposition <span class="title">fromJsonSync</span><span class="params">(Resources res, JSONObject json)</span> </span>&#123;</div><div class="line">      Rect bounds = <span class="keyword">null</span>;</div><div class="line">      <span class="keyword">float</span> scale = res.getDisplayMetrics().density;</div><div class="line">      <span class="keyword">int</span> width = json.optInt(<span class="string">"w"</span>, -<span class="number">1</span>);</div><div class="line">      <span class="keyword">int</span> height = json.optInt(<span class="string">"h"</span>, -<span class="number">1</span>);</div><div class="line"></div><div class="line">      <span class="keyword">if</span> (width != -<span class="number">1</span> &amp;&amp; height != -<span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">int</span> scaledWidth = (<span class="keyword">int</span>) (width * scale);</div><div class="line">        <span class="keyword">int</span> scaledHeight = (<span class="keyword">int</span>) (height * scale);</div><div class="line">        bounds = <span class="keyword">new</span> Rect(<span class="number">0</span>, <span class="number">0</span>, scaledWidth, scaledHeight);</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      <span class="keyword">long</span> startFrame = json.optLong(<span class="string">"ip"</span>, <span class="number">0</span>);</div><div class="line">      <span class="keyword">long</span> endFrame = json.optLong(<span class="string">"op"</span>, <span class="number">0</span>);</div><div class="line">      <span class="keyword">int</span> frameRate = json.optInt(<span class="string">"fr"</span>, <span class="number">0</span>);</div><div class="line">      LottieComposition composition =</div><div class="line">          <span class="keyword">new</span> LottieComposition(bounds, startFrame, endFrame, frameRate, scale);</div><div class="line">      JSONArray assetsJson = json.optJSONArray(<span class="string">"assets"</span>);</div><div class="line">      parseImages(assetsJson, composition);</div><div class="line">      parsePrecomps(assetsJson, composition);</div><div class="line">      parseLayers(json, composition);</div><div class="line">      <span class="keyword">return</span> composition;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è§£æå‡ºäº†åŠ¨ç”»çš„å®½é«˜ã€å¸§ç‡ç­‰ä¿¡æ¯ï¼Œè¿™é‡Œå°†è§£æå‡ºæ¥çš„å®½é«˜ä¹˜ä¸Šäº†å±å¹•çš„åƒç´ å¯†åº¦ï¼Œç„¶åè®¾ç½®æ¸²æŸ“åŒºåŸŸçš„è¾¹ç•Œï¼Œä¸ºäº†ä¾¿äºç†è§£ï¼Œæœ¬æ–‡å°†å…¶ç§°ä¸ºç”»å¸ƒã€‚æˆ‘è¿™å°æ‰‹æœºæ˜¯ 1080P çš„åˆ†è¾¨ç‡ï¼Œdensity = 3ï¼ŒscaledWidth = 2250ï¼ŒscaledHeight = 4002ï¼Œç°åœ¨ç¼©æ”¾åçš„ç”»å¸ƒå®½é«˜æ¯”æ‰‹æœºå±å¹•å¤§äº†å¤ªå¤šï¼Œå¦‚æœåŠ¨ç”»åœ¨è¿™ç§å°ºå¯¸ä¸‹è¿›è¡Œæ¸²æŸ“è‚¯å®šä¸è¡Œã€‚æ‰€ä»¥ LottieAnimationView åŠ è½½ Composition æ—¶åˆ¤æ–­äº†ç”»å¸ƒçš„å®½é«˜å¦‚æœå¤§äºæ‰‹æœºå±å¹•çš„å®½é«˜å°±è¿›è¡Œç­‰æ¯”ä¾‹ç¼©å°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setComposition</span><span class="params">(@NonNull LottieComposition composition)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (L.DBG) &#123;</div><div class="line">      Log.v(TAG, <span class="string">"Set Composition \n"</span> + composition);</div><div class="line">    &#125;</div><div class="line">    lottieDrawable.setCallback(<span class="keyword">this</span>);</div><div class="line"></div><div class="line">    <span class="keyword">boolean</span> isNewComposition = lottieDrawable.setComposition(composition);</div><div class="line">    <span class="keyword">if</span> (!isNewComposition) &#123;</div><div class="line">      <span class="comment">// We can avoid re-setting the drawable, and invalidating the view, since the composition</span></div><div class="line">      <span class="comment">// hasn't changed.</span></div><div class="line">      <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//é‡ç‚¹åœ¨è¿™é‡Œï¼Œæ ¹æ®å±å¹•å®½é«˜å¯¹ç”»å¸ƒè¿›è¡Œç­‰æ¯”ä¾‹ç¼©æ”¾</span></div><div class="line">    <span class="keyword">int</span> screenWidth = Utils.getScreenWidth(getContext());</div><div class="line">    <span class="keyword">int</span> screenHeight = Utils.getScreenHeight(getContext());</div><div class="line">    <span class="keyword">int</span> compWidth = composition.getBounds().width();</div><div class="line">    <span class="keyword">int</span> compHeight = composition.getBounds().height();</div><div class="line">    <span class="comment">//å¦‚æœç”»å¸ƒçš„å®½é«˜å¤§äºå±å¹•å®½é«˜ï¼Œè®¡ç®—ç¼©æ”¾æ¯”</span></div><div class="line">    <span class="keyword">if</span> (compWidth &gt; screenWidth ||</div><div class="line">        compHeight &gt; screenHeight) &#123;</div><div class="line">      <span class="keyword">float</span> xScale = screenWidth / (<span class="keyword">float</span>) compWidth;</div><div class="line">      <span class="keyword">float</span> yScale = screenHeight / (<span class="keyword">float</span>) compHeight;</div><div class="line">      <span class="comment">//æŒ‰æ¯”ä¾‹ç¼©å°</span></div><div class="line">      setScale(Math.min(xScale, yScale));</div><div class="line">      Log.w(L.TAG, String.format(</div><div class="line">          <span class="string">"Composition larger than the screen %dx%d vs %dx%d. Scaling down."</span>,</div><div class="line">          compWidth, compHeight, screenWidth, screenHeight));</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// If you set a different composition on the view, the bounds will not update unless</span></div><div class="line">    <span class="comment">// the drawable is different than the original.</span></div><div class="line">    setImageDrawable(<span class="keyword">null</span>);</div><div class="line">    setImageDrawable(lottieDrawable);</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.composition = composition;</div><div class="line"></div><div class="line">    requestLayout();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è®¡ç®—å‡ºå®½å’Œé«˜çš„ç¼©æ”¾æ¯”åï¼Œä¸ºäº†è®©ç”»å¸ƒå°äºå±å¹•ï¼Œæ‰€ä»¥å–è¾ƒå°çš„ä¸€ä¸ªæ¯”ä¾‹ï¼Œè°ƒç”¨ setScale æ–¹æ³•å°†ç¼©æ”¾æ¯”è®¾ç½®åˆ° lottieDrawable ä¸Šï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setScale</span><span class="params">(<span class="keyword">float</span> scale)</span> </span>&#123;</div><div class="line">    lottieDrawable.setScale(scale);</div><div class="line">    <span class="keyword">if</span> (getDrawable() == lottieDrawable) &#123;</div><div class="line">      setImageDrawable(<span class="keyword">null</span>);</div><div class="line">      setImageDrawable(lottieDrawable);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>lottieDrawable çš„ setScale æ–¹æ³•ä¿å­˜äº†ç¼©æ”¾æ¯”ï¼Œå¹¶ä¸”æ›´æ–°äº†ç»˜åˆ¶çš„çŸ©å½¢èŒƒå›´ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setScale</span><span class="params">(<span class="keyword">float</span> scale)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.scale = scale;</div><div class="line">    updateBounds();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œå¯ä»¥çœ‹åˆ°çŸ©å½¢çš„èŒƒå›´æ˜¯æ ¹æ®ç”»å¸ƒçš„å®½é«˜è¿›è¡Œäº†ç­‰æ¯”ä¾‹çš„ç¼©æ”¾</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">updateBounds</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (composition == <span class="keyword">null</span>) &#123;</div><div class="line">      <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    setBounds(<span class="number">0</span>, <span class="number">0</span>, (<span class="keyword">int</span>) (composition.getBounds().width() * scale),</div><div class="line">        (<span class="keyword">int</span>) (composition.getBounds().height() * scale));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç°åœ¨ç”»å¸ƒè¢«ç¼©æ”¾äº†ï¼Œç„¶è€ŒèƒŒæ™¯å›¾å‘¢ï¼Ÿæ¥çœ‹ä¸€ä¸‹ lottieDrawable çš„ç»˜åˆ¶ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">(@NonNull Canvas canvas)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (compositionLayer == <span class="keyword">null</span>) &#123;</div><div class="line">      <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    matrix.reset();</div><div class="line">    matrix.preScale(scale, scale);</div><div class="line">    compositionLayer.draw(canvas, matrix, alpha);</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p>lottieDrawable åœ¨ç»˜åˆ¶çš„æ—¶å€™å¯¹ matrix è®¾ç½®äº†ç¼©æ”¾æ¯”ï¼Œç„¶åè°ƒç”¨äº† compositionLayer å»è¿›è¡Œå…·ä½“çš„ç»˜åˆ¶ã€‚è¿™ä¸ª compositionLayer å°±æ˜¯æ‰€æœ‰å›¾å±‚çš„ä¸€ä¸ªç»„åˆï¼Œå®ƒæœ‰ä¸€ä¸ª<code>List&lt;BaseLayer&gt; layers</code>å±æ€§ï¼Œ è¿™ä¸ªå±æ€§å°±æ˜¯ json æ–‡ä»¶é‡Œé¢çš„<code>layers</code>èŠ‚ç‚¹è§£æå‡ºæ¥çš„å›¾å±‚åˆ—è¡¨ï¼Œæ¯ä¸ªå›¾å±‚ä¸­é—´è¿˜åŒ…å«ä¸€äº›å±æ€§åŠ¨ç”»ã€‚<code>compositionLayer.draw(canvas, matrix, alpha)</code>æ–¹æ³•ä¸­ä¸»è¦è°ƒç”¨äº† drawLayer æŠ½è±¡æ–¹æ³•ç”±å›¾å±‚çš„å…·ä½“å®ç°ç±»æ‰§è¡Œç»˜åˆ¶ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">drawLayer</span><span class="params">(Canvas canvas, Matrix parentMatrix, <span class="keyword">int</span> parentAlpha)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = layers.size() - <span class="number">1</span>; i &gt;= <span class="number">0</span> ; i--) &#123;</div><div class="line">      layers.get(i).draw(canvas, parentMatrix, parentAlpha);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ° CompositionLayer ç±»çš„ drawLayer æ–¹æ³•éå† layers é›†åˆè¿›è¡Œå¾ªç¯ç»˜åˆ¶ï¼Œè¿™é‡Œæ˜¯ä½¿ç”¨å›¾ç‰‡æ–‡ä»¶åšçš„åŠ¨ç”»ï¼Œå¯¹åº”çš„ Layer å®ç°ç±»ä¸º ImageLayerã€‚ çœ‹ä¸‹ ImageLayer çš„ç»˜åˆ¶æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawLayer</span><span class="params">(@NonNull Canvas canvas, Matrix parentMatrix, <span class="keyword">int</span> parentAlpha)</span> </span>&#123;</div><div class="line">    Bitmap bitmap = getBitmap();</div><div class="line">    <span class="keyword">if</span> (bitmap == <span class="keyword">null</span>) &#123;</div><div class="line">      <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    paint.setAlpha(parentAlpha);</div><div class="line">    canvas.save();</div><div class="line">    canvas.concat(parentMatrix);</div><div class="line">    src.set(<span class="number">0</span>, <span class="number">0</span>, bitmap.getWidth(), bitmap.getHeight());</div><div class="line">    dst.set(<span class="number">0</span>, <span class="number">0</span>, (<span class="keyword">int</span>) (bitmap.getWidth() * density), (<span class="keyword">int</span>) (bitmap.getHeight() * density));</div><div class="line">    canvas.drawBitmap(bitmap, src, dst , paint);</div><div class="line">    canvas.restore();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>getBitmap() æ–¹æ³•ä¼šè°ƒç”¨åˆ°ä¸€å¼€å§‹è®¾ç½®çš„ä»£ç†ç±» ImageAssetDelegate ï¼Œä» SD å¡åŠ è½½å›¾ç‰‡ã€‚  </p>
<p>ä»£ç ä¸­è°ƒç”¨äº† canvas çš„<code>save</code>ã€<code>restore</code>æ–¹æ³•æ¥è¿›è¡Œå›¾å±‚çš„å åŠ ç»˜åˆ¶ï¼Œä» lottieDrawable çš„<code>draw</code>æ–¹æ³•ä¼ é€’ä¸‹æ¥çš„<code>matrix</code>ç”¨åˆ°äº†<code>concat</code>æ–¹æ³•ä¸Šï¼Œå¯¹ bitmap è¿›è¡Œäº†ç­‰æ¯”ç¼©æ”¾ã€‚</p>
<p>æ•´ä¸ªæµç¨‹è·‘ä¸‹æ¥ï¼ŒLottie åº“çš„åŠ¨ç”»æ¸²æŸ“æœºåˆ¶å·²ç»åŸºæœ¬äº†è§£ï¼ŒèƒŒæ™¯å›¾æ²¡æœ‰å…¨å±å±•ç¤ºçš„åŸå› å¦‚ä¸‹ï¼š</p>
<p><strong>èƒŒæ™¯å›¾çš„é•¿å®½æ¯”æ˜¯ 16 : 9ï¼Œæ‰‹æœºå±å¹•çš„é•¿å®½æ¯”ä¹Ÿæ˜¯ 16 : 9ï¼Œä½†æ˜¯å› ä¸ºåº•éƒ¨çš„è™šæ‹ŸæŒ‰é”®å äº†ä¸€éƒ¨åˆ†çš„é«˜åº¦ï¼Œå±å¹•å¯ç”¨ç©ºé—´çš„é•¿å®½æ¯”å¤§çº¦ä¸º 3 : 2ï¼Œæ‰€ä»¥å¯¼è‡´èƒŒæ™¯å›¾ä¸èƒ½é“ºæ»¡å±å¹•</strong></p>
<h2 id="å…¨å±é€‚é…"><a href="#å…¨å±é€‚é…" class="headerlink" title="å…¨å±é€‚é…"></a>å…¨å±é€‚é…</h2><p>åŠ¨ç”»ä¸èƒ½å…¨å±æœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯æ‰‹æœºé•¿å®½æ¯”å’Œç”»å¸ƒçš„é•¿å®½æ¯”æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯çŠ¶æ€æ ã€å¯¼èˆªæ å äº†å±å¹•ä¸€éƒ¨åˆ†ç©ºé—´å¯¼è‡´ä¸èƒ½å…¨å±ï¼Œä½¿ç”¨æ–¹æ¡ˆä¸€å¯ä»¥è§£å†³é—®é¢˜ã€‚è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯æ‰‹æœºå±å¹•é•¿å®½æ¯”å’Œç”»å¸ƒçš„é•¿å®½æ¯”å°±æ˜¯ä¸ä¸€æ ·ï¼Œæ¯•ç«Ÿ Android æœºå‹è¿™ä¹ˆå¤šï¼Œæœ‰å‡ å°å¥‡è‘©æ‰‹æœºå¾ˆæ­£å¸¸ï¼Œé‚£ä¹ˆä½¿ç”¨æ–¹æ¡ˆäºŒå¯ä»¥å®ç°å…¨å±ã€‚</p>
<h3 id="æ–¹æ¡ˆä¸€"><a href="#æ–¹æ¡ˆä¸€" class="headerlink" title="æ–¹æ¡ˆä¸€"></a>æ–¹æ¡ˆä¸€</h3><p>åœ¨æ‰§è¡ŒåŠ¨ç”»çš„ç•Œé¢éšè—è™šæ‹ŸæŒ‰é”®ï¼Œæˆ–è€…å°†è™šæ‹ŸæŒ‰é”®è®¾ç½®ä¸ºé€æ˜æµ®åœ¨å¸ƒå±€ä¸Šé¢ï¼Œè¿™æ ·å±å¹•çš„é•¿å®½æ¯”å’Œç”»å¸ƒçš„é•¿å®½æ¯”ä¸€æ ·å°±æ²¡æœ‰é—®é¢˜ã€‚ç›®å‰å¸‚é¢ä¸Šçš„æ‰‹æœºåŸºæœ¬ä¸Šéƒ½æ˜¯ 720Pã€1080Pã€2K ç­‰åˆ†è¾¨ç‡ï¼Œè¿™äº›åˆ†è¾¨ç‡éƒ½æ˜¯ 16 : 9 çš„å°ºå¯¸ã€‚</p>
<p>çŠ¶æ€æ å’Œè™šæ‹ŸæŒ‰é”®é€æ˜æ‚¬æµ®åœ¨å¸ƒå±€ä¸Šé¢ï¼Œè®¾ç½®æ ·å¼ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"Theme"</span>&gt;</span><span class="xml"></span></div><div class="line">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:windowTranslucentStatus"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:windowTranslucentNavigation"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div></pre></td></tr></table></figure>
<p>éšè—è™šæ‹ŸæŒ‰é”®é€šè¿‡ä»£ç è®¾ç½®ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">Window window = getWindow();</div><div class="line"><span class="keyword">int</span> visibility = View.SYSTEM_UI_FLAG_HIDE_NAVIGATION |</div><div class="line">                View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN |</div><div class="line">                View.SYSTEM_UI_FLAG_LAYOUT_STABLE |</div><div class="line">                View.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION;</div><div class="line"><span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) &#123;</div><div class="line">    window.clearFlags(WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS);</div><div class="line">    window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS);</div><div class="line">    window.setStatusBarColor(ContextCompat</div><div class="line">                    .getColor(getActivity(), android.R.color.transparent));</div><div class="line">    visibility |= View.SYSTEM_UI_FLAG_IMMERSIVE_STICKY;</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) &#123;</div><div class="line">    window.addFlags(WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS);</div><div class="line">    visibility |= View.SYSTEM_UI_FLAG_IMMERSIVE_STICKY;</div><div class="line">&#125;</div><div class="line">window.getDecorView().setSystemUiVisibility(visibility);</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ä»£ç éšè—è™šæ‹ŸæŒ‰é”®éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼š<strong>ç•Œé¢çš„åˆ‡æ¢ä¼šå¯¼è‡´ setSystemUiVisibility() çš„è®¾ç½®è¢«æ¸…ç©ºï¼Œæœ€å¥½æ˜¯åœ¨ onResume() æˆ–è€… onWindowFocusChanged() æ–¹æ³•ä¸­è¿›è¡Œè®¾ç½®ã€‚</strong></p>
<h3 id="æ–¹æ¡ˆäºŒ"><a href="#æ–¹æ¡ˆäºŒ" class="headerlink" title="æ–¹æ¡ˆäºŒ"></a>æ–¹æ¡ˆäºŒ</h3><p>å¦‚æœè¦é€‚é…å…¶ä»–é•¿å®½æ¯”çš„å±å¹•ï¼Œå’‹åŠå‘¢ï¼Ÿä¸¤è¡Œä»£ç è§£å†³é—®é¢˜ï¼Œåªä¸è¿‡å›¾ç‰‡æœ‰ä¸€éƒ¨åˆ†ä¼šè¢«è£å‰ªã€‚è®¾ç½®æ§ä»¶çš„å®½é«˜ä¸º<code>match_parent</code>ï¼Œè®¾ç½®<code>android:scaleType</code>ä¸º<code>centerCrop</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">com.airbnb.lottie.LottieAnimationView</span></span></div><div class="line">        <span class="attr">android:id</span>=<span class="string">"@+id/lottieAnimationView"</span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:scaleType</span>=<span class="string">"centerCrop"</span>/&gt;</div></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>Lottie å‘å¸ƒæ‰å‡ ä¸ªæœˆï¼Œå¾ˆå¤šåŠŸèƒ½è¿˜ä¸å¤Ÿå®Œå–„ï¼Œç¼“å­˜æœºåˆ¶ä¹Ÿæ¯”è¾ƒå¼±ï¼Œåƒè¿™ç§ä» SD å¡åŠ¨æ€åŠ è½½çš„æ–¹å¼ï¼Œéœ€è¦è‡ªå·±å»å®ç°ç¼“å­˜é€»è¾‘ã€‚ä½†æ˜¯è¿™ç‚¹å°ç‘•ç–µæ©ç›–ä¸äº†ç‰›é€¼çš„äº‹å®ï¼Œå°±ç›®å‰è¿™ä¸ªéœ€æ±‚æ¥è¯´ï¼Œå·²ç»å¤§å¤§çš„é™ä½äº†å¼€å‘æˆæœ¬ã€‚åªä¸è¿‡è®¾è®¡å¸ˆä»¬éœ€è¦å¥½å¥½ç»ƒç»ƒ AE äº†ï¼ŒåŠ¨ç”»ç‚«ä¸ç‚«å°±çœ‹è®¾è®¡å¸ˆç»™ä¸ç»™åŠ›å•¦ğŸ˜†ğŸ˜†</p>
<p>æœ¬æ–‡æ˜¯ä½œè€…çš„å¤„å¥³ä½œï¼Œå¦‚æœå¯¹å¤§å®¶æœ‰å¸®åŠ©ï¼Œå¸Œæœ›å¤§å®¶å¤šå¤šæ”¯æŒï¼Œç»™äºˆä½œè€…æ›´å¤šçš„åˆ›ä½œåŠ¨åŠ›ï¼Œæä¾›æ›´å¥½çš„ä½œå“ç»™å¤§å®¶ã€‚  </p>
<p><center>æ¬¢è¿å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ï¼š<strong>å¤§è„‘å¥½é¥¿</strong>ï¼Œæ›´å¤šå¹²è´§ç­‰ä½ æ¥å°</center><br><img title="å…¬ä¼—å·ï¼šå¤§è„‘å¥½é¥¿" src="http://images.imliujun.com/static/images/wx_qrcode.png"></p>
</div><iframe src="http://www.liujun.info/donate-page/simple/" style="overflow-x:hidden;overflow-y:hidden; border:0xp none #fff; min-height:240px; width:100%;"  frameborder="0" scrolling="no"></iframe><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://www.imliujun.com/Lottieåº“å®ç°ç›´æ’­ç¤¼ç‰©åŠ¨ç”».html" data-id="cj4zfx99y000ih2fybpoehl4f" class="article-share-link">åˆ†äº«</a><div class="tags"><a href="/tags/Lottie/">Lottie</a><a href="/tags/ç›´æ’­/">ç›´æ’­</a><a href="/tags/åŠ¨æ€åŠ è½½/">åŠ¨æ€åŠ è½½</a><a href="/tags/ç¤¼ç‰©/">ç¤¼ç‰©</a><a href="/tags/åŠ¨ç”»/">åŠ¨ç”»</a></div><div class="post-nav"><a href="/hello-world.html" class="pre">Hello World</a><a href="/gradle1.html" class="next">ä½¿ç”¨ Gradle å¯¹åº”ç”¨è¿›è¡Œä¸ªæ€§åŒ–å®šåˆ¶</a></div><div id="SOHUCS" sid="1493076431000"></div><script>(function(){var appid='cyt4LaybM';var conf='prod_ba6c39a7ee3948f6aafec787e567e6b7';var width=window.innerWidth||document.documentElement.clientWidth;if(width<960){window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id='+appid+'&conf='+conf+'"><\/script>')}else{var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})})}})()
</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://www.imliujun.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> åˆ†ç±»</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> æ ‡ç­¾</i></div><div class="tagcloud"><a href="/tags/Gradle/" style="font-size: 15px;">Gradle</a> <a href="/tags/Lottie/" style="font-size: 15px;">Lottie</a> <a href="/tags/ç›´æ’­/" style="font-size: 15px;">ç›´æ’­</a> <a href="/tags/åŠ¨æ€åŠ è½½/" style="font-size: 15px;">åŠ¨æ€åŠ è½½</a> <a href="/tags/ç¤¼ç‰©/" style="font-size: 15px;">ç¤¼ç‰©</a> <a href="/tags/åŠ¨ç”»/" style="font-size: 15px;">åŠ¨ç”»</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> æœ€è¿‘æ–‡ç« </i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/gradle3.html">ä½¿ç”¨ Gradle å®ç°ä¸€å¥—ä»£ç å¼€å‘å¤šä¸ªåº”ç”¨</a></li><li class="post-list-item"><a class="post-list-link" href="/gradle2.html">Android Studio 3.0 ä¸Š Gradle æ”¹åŠ¨</a></li><li class="post-list-item"><a class="post-list-link" href="/gradle1.html">ä½¿ç”¨ Gradle å¯¹åº”ç”¨è¿›è¡Œä¸ªæ€§åŒ–å®šåˆ¶</a></li><li class="post-list-item"><a class="post-list-link" href="/Lottieåº“å®ç°ç›´æ’­ç¤¼ç‰©åŠ¨ç”».html">Lottie -- è½»æ¾å®ç°åŠ¨æ€åŠ è½½ç›´æ’­ç¤¼ç‰©åŠ¨ç”»</a></li><li class="post-list-item"><a class="post-list-link" href="/hello-world.html">Hello World</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> å‹æƒ…é“¾æ¥</i></div><ul></ul><a href="http://jinweime.com/" title="JinWei" target="_blank">JinWei</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2017 <a href="/." rel="nofollow">å¤§è„‘å¥½é¥¿.</a><a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn/"> äº¬ICPå¤‡14053652å·-1</a><div></div> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.css"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?88a3cbe2051fe51ad73ae8e48687dcbd";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>
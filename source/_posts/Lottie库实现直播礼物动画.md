title: Lottie -- è½»æ¾å®ç°åŠ¨æ€åŠ è½½ç›´æ’­ç¤¼ç‰©åŠ¨ç”»
tags:
- Lottie
- ç›´æ’­
- åŠ¨æ€åŠ è½½
- ç¤¼ç‰©
- åŠ¨ç”»
date: 2017-04-25 07:27:11
categories: Android
toc: true
comments: true
description: Lottieï¼Œè½»æ¾å®ç°ç‚«é…·åŠ¨ç”»ï¼Œè®© app åŠ è½½åŠ¨ç”»åƒåŠ è½½å›¾ç‰‡ä¸€æ ·ç®€å•ã€‚å‡ åˆ†é’Ÿæ—¶é—´è®©ä½ å­¦ä¼šåŠ¨æ€åŠ è½½èµ„æºå®ç°ç‚«é…·ç¤¼ç‰©åŠ¨ç”»ï¼Œå®Œç¾é€‚é…å®‰å“å„æœºå‹ã€‚
---
>æœ¬æ–‡å·²æˆæƒå¾®ä¿¡å…¬ä¼—å·ï¼šé¸¿æ´‹ï¼ˆhongyangAndroidï¼‰åŸåˆ›é¦–å‘ã€‚

æœ¬æ–‡ä¸»è¦è®²è§£ [Lottie](https://github.com/airbnb/lottie-android) åº“åŠ¨æ€åŠ è½½ SD å¡ä¸Šå¸¦å›¾ç‰‡èµ„æºçš„åŠ¨ç”»ï¼Œå¹¶å¯¹å„ç§æœºå‹åšå…¨å±é€‚é…ã€‚

Lottie çš„ä¼˜ç‚¹ï¼š

* è·¨å¹³å°ï¼Œæ”¯æŒ Androidã€iOSã€React Native å¹³å°

* æ”¯æŒå®æ—¶æ¸²æŸ“ After Effects åŠ¨ç”»ï¼Œè®© app åŠ è½½åŠ¨ç”»åƒåŠ è½½å›¾ç‰‡ä¸€æ ·ç®€å•ã€‚

* èµ„æºåŠ¨æ€ä¸‹è½½ï¼Œå‡å° APP ä½“ç§¯ï¼Œä¸Šçº¿æ–°çš„åŠ¨ç”»æ•ˆæœä¸éœ€è¦å‘ç‰ˆ

* æ›´å¤šä¼˜ç‚¹ç­‰ä½ å‘ç°

## ä½¿ç”¨åœºæ™¯

* åšç›´æ’­è½¯ä»¶è‚¯å®šå°‘ä¸äº†å„ç§ç¤¼ç‰©çš„åŠ¨ç”»æ•ˆæœï¼Œå½“ä¸Šçº¿æ–°çš„ç¤¼ç‰©æ—¶ï¼Œä¸ä»… Androidã€ios å®¢æˆ·ç«¯éœ€è¦å®ç°æ–°çš„åŠ¨ç”»æ•ˆæœï¼Œè¿˜å¾ˆéš¾å…¼å®¹è€ç‰ˆæœ¬ã€‚

* å¹³å¸¸è¿‡èŠ‚æ—¥çš„æ—¶å€™ï¼Œå¾ˆå¤š APP éƒ½ä¼šåšå„ç§æ´»åŠ¨ï¼Œä¿®æ”¹å¯åŠ¨é¡µçš„å›¾ç‰‡ï¼Œæ›´æ”¹åº”ç”¨å†…çš„æŒ‰é’®å›¾æ ‡ï¼Œå¦‚æœæ¶‰åŠåˆ°åŠ¨ç”»ï¼Œé‚£ä¹ˆè‚¯å®šéœ€è¦æå‰ä¸€ä¸¤ä¸ªç‰ˆæœ¬å°†èŠ‚æ—¥çš„åŠ¨ç”»å®ç°ä»£ç é¢„åˆ¶åˆ°åº”ç”¨å†…

* æ›´å¤šåº”ç”¨åœºæ™¯ç­‰ä½ æ¢ç´¢

ç°åœ¨æœ‰äº† Lottieï¼Œå¯ä»¥è®©è®¾è®¡å¸ˆä½¿ç”¨ After Effects è¿›è¡ŒåŠ¨ç”»è®¾è®¡ï¼Œé€šè¿‡ Bodymovin æ’ä»¶å¯¼å‡º json æ–‡ä»¶ï¼Œå°†åŠ¨ç”»èµ„æºæ‰“åŒ…ä¸Šä¼ åˆ°æœåŠ¡å™¨åï¼Œå®¢æˆ·ç«¯é€šè¿‡åŠ¨æ€ä¸‹è½½èµ„æºæ–‡ä»¶æ¥æ‰§è¡ŒåŠ¨ç”»ã€‚è¿™æ ·ä¸Šçº¿æ–°çš„ç¤¼ç‰©ï¼Œåªéœ€è¦å°†èµ„æºæ–‡ä»¶ä¸Šä¼ ï¼Œå®¢æˆ·ç«¯ä¸éœ€è¦å‘ç‰ˆå®Œå…¨å¯ä»¥æ‰§è¡Œæ–°ç¤¼ç‰©çš„åŠ¨ç”»æ•ˆæœã€‚æµç¨‹å¦‚ä¸‹ï¼š

{% qnimg Lottie/Lottie_9.jpeg title:æµç¨‹å›¾  %}  

## ä½¿ç”¨è¯¦è§£

æœ¬æ–‡å°±ä»¥ç›´æ’­é—´æ’­æ”¾åŠ¨ç”»ä¸ºä¾‹å­æ¥è®²è§£å…·ä½“çš„å®ç°æ–¹æ¡ˆï¼Œå…ˆçœ‹ä¸‹åŠ¨ç”»æ•ˆæœï¼š

{% qnimg Lottie/Lottie_1.gif title:åŠ¨ç”»æ•ˆæœ  %}  

ç›´æ’­è½¯ä»¶çš„å¤§ç¤¼ç‰©ä¸€èˆ¬éƒ½æ˜¯é£æœºã€è·‘è½¦ã€èˆªæ¯ã€èŠ±ç“£é›¨ç­‰ï¼Œè¿™äº›ç‰©å“ä¸æ˜¯ç®€å•çš„çº¿æ¡ã€è‰²å—æ‰€èƒ½ç»˜åˆ¶ï¼Œæ‰€ä»¥ä½¿ç”¨å›¾ç‰‡æ–‡ä»¶æ¥å®ç°åŠ¨ç”»æ•ˆæœã€‚  
å¯¼å‡ºçš„åŠ¨ç”»èµ„æºåŒ…æ‹¬ä¸€ä¸ª json æ–‡ä»¶å’Œä¸€ç»„å›¾ç‰‡æ–‡ä»¶ï¼š

{% qnimg Lottie/Lottie_2.jpg title:èµ„æºæ–‡ä»¶ç›®å½•  %}

å°†è¿™äº›æ–‡ä»¶æ‰“æˆå‹ç¼©åŒ…ä¸Šä¼ åˆ°åå°ï¼Œå®¢æˆ·ç«¯ä¸‹è½½å‹ç¼©åŒ…è¿›è¡Œè§£å‹ï¼Œä½¿ç”¨ Lottie åŠ è½½æœ¬åœ°èµ„æºæ‰§è¡ŒåŠ¨ç”»ï¼š

```java
File jsonFile = new File(giftDir, "79.json");
File imagesDir = new File(giftDir, "images");
FileInputStream fis = null;
if (jsonFile.exists()) {
    try {
        fis = new FileInputStream(jsonFile);
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    }
}
if (fis == null || !imagesDir.exists()) {
    showLocalAnimation(gift);
    return;
}
final String absolutePath = imagesDir.getAbsolutePath();
//æä¾›ä¸€ä¸ªä»£ç†æ¥å£ä» SD å¡è¯»å– images ä¸‹çš„å›¾ç‰‡
mLottieAnimationView.setImageAssetDelegate(new ImageAssetDelegate() {
    @Override
    public Bitmap fetchBitmap(LottieImageAsset asset) {
        BitmapFactory.Options opts = new BitmapFactory.Options();
        opts.inScaled = true;
        opts.inDensity = 160;
        return BitmapFactory.decodeFile(absolutePath + File.separator +
                asset.getFileName(), opts);
    }
});
//ä»æ–‡ä»¶æµä¸­åŠ è½½ json æ•°æ®
LottieComposition.Factory.fromInputStream(this, fis, new OnCompositionLoadedListener() {
    @Override
    public void onCompositionLoaded(LottieComposition composition) {
        mLottieAnimationView.setVisibility(View.VISIBLE);
        mLottieAnimationView.setComposition(composition);
        mLottieAnimationView.playAnimation();
    }
});

```

å…³é”®çš„ä»£ç å°±æ˜¯è®¾ç½®å›¾ç‰‡èµ„æºä»£ç†ï¼Œå» SD å¡è§£æå›¾ç‰‡æ–‡ä»¶ï¼Œé‚£ä¹ˆæ€ä¹ˆçŸ¥é“è¯¥è§£æå“ªä¸€å¼ å›¾ç‰‡å‘¢ï¼Ÿå’±ä»¬æ¥çœ‹çœ‹ json æ–‡ä»¶é‡Œé¢çš„å†…å®¹ï¼š

{% qnimg Lottie/Lottie_7.jpg title:jsonæ–‡ä»¶  %}  

`assets` å­—æ®µæ˜¯å›¾ç‰‡èµ„æºçš„æ•°ç»„ï¼Œå…·ä½“çš„è§£æçš„æºç å¦‚ä¸‹ï¼š

```java
private LottieImageAsset(int width, int height, String id, String fileName) {
    this.width = width;
    this.height = height;
    this.id = id;
    this.fileName = fileName;
}

static class Factory {
    private Factory() {}

    static LottieImageAsset newInstance(JSONObject imageJson) {
        return new LottieImageAsset(
                  imageJson.optInt("w"),     //width
                  imageJson.optInt("h"),     //height
                  imageJson.optString("id"), //id
                  imageJson.optString("p")   //fileName
               );
    }
}
```

ç›´æ¥æ ¹æ® `ImageAssetDelegate` ä»£ç†ç±»çš„ `fetchBitmap(LottieImageAsset asset)` æ–¹æ³•ä¸­çš„ `LottieImageAsset` å‚æ•°è·å–å½“å‰éœ€è¦è§£æçš„å›¾ç‰‡æ–‡ä»¶åï¼Œå» images æ–‡ä»¶å¤¹ä¸‹é¢è§£æå¯¹åº”çš„æ–‡ä»¶å°±OKå•¦ã€‚

è¿™å‡ è¡Œä»£ç å°±å®ç°äº†ä»SDå¡åŠ¨æ€åŠ è½½åŠ¨ç”»ï¼Œé‚£ä¹ˆè¿™æ ·å°±ç®—å®Œå·¥äº†å—ï¼Ÿçœ‹çœ‹ä¸Šé¢çš„åŠ¨ç”»æ˜¯ä¸æ˜¯æ„Ÿè§‰æœ‰ä»€ä¹ˆåœ°æ–¹ä¸å¯¹åŠ²ï¼Ÿå¥½å§ï¼Œä½œä¸ºä¸€ä¸ª Android è½¯ä»¶å·¥ç¨‹å¸ˆï¼Œä¸€å®šè¦è®°ä½2ä¸ªå­— **é€‚é…** **é€‚é…** **é€‚é…**

## æºç è§£æ

åŠ¨ç”»æ˜¯å…¨å±çš„æ•ˆæœï¼Œå°å¹½çµä¹Ÿæ˜¯ä»å±å¹•å¤–é£è¿›æ¥çš„æ²¡æœ‰é—®é¢˜ï¼Œä¸ºä»€ä¹ˆèƒŒæ™¯å›¾ç¦»å±å¹•ä¸¤è¾¹æœ‰ç©ºéš™å‘¢ï¼Ÿ

{% qnimg Lottie/Lottie_4.jpg title:æ²¡æœ‰å±å¹•é€‚é…çš„æ•ˆæœ  %}

å†æ¥çœ‹çœ‹è¿™ä¸ªåŠ¨å›¾ï¼Œ**ä¸ºä»€ä¹ˆéšè—è™šæ‹ŸæŒ‰é”®å°±å…¨å±äº†å‘¢ï¼Ÿ**

{% qnimg Lottie/Lottie_5.gif title:éšè—è™šæ‹ŸæŒ‰é”®  %}

å†æ¥çœ‹çœ‹ json æ–‡ä»¶é‡Œé¢çš„å†…å®¹ï¼š

{% qnimg Lottie/Lottie_7.jpg title:jsonæ–‡ä»¶  %}

èƒŒæ™¯å›¾çš„å®½é«˜å’Œç”»å¸ƒçš„å®½é«˜æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆæœ‰è™šæ‹ŸæŒ‰é”®çš„æ—¶å€™èƒŒæ™¯å›¾å°±ä¸å…¨å±å‘¢ï¼ŸåŸå› å…¶å®å¾ˆç®€å•ï¼Œæ¥çœ‹ä¸€ä¸‹ Lottie æ˜¯æ€ä¹ˆè§£æ json æ•°æ®ï¼š

```java
static LottieComposition fromJsonSync(Resources res, JSONObject json) {
      Rect bounds = null;
      float scale = res.getDisplayMetrics().density;
      int width = json.optInt("w", -1);
      int height = json.optInt("h", -1);

      if (width != -1 && height != -1) {
        int scaledWidth = (int) (width * scale);
        int scaledHeight = (int) (height * scale);
        bounds = new Rect(0, 0, scaledWidth, scaledHeight);
      }

      long startFrame = json.optLong("ip", 0);
      long endFrame = json.optLong("op", 0);
      int frameRate = json.optInt("fr", 0);
      LottieComposition composition =
          new LottieComposition(bounds, startFrame, endFrame, frameRate, scale);
      JSONArray assetsJson = json.optJSONArray("assets");
      parseImages(assetsJson, composition);
      parsePrecomps(assetsJson, composition);
      parseLayers(json, composition);
      return composition;
}
```

è§£æå‡ºäº†åŠ¨ç”»çš„å®½é«˜ã€å¸§ç‡ç­‰ä¿¡æ¯ï¼Œè¿™é‡Œå°†è§£æå‡ºæ¥çš„å®½é«˜ä¹˜ä¸Šäº†å±å¹•çš„åƒç´ å¯†åº¦ï¼Œç„¶åè®¾ç½®æ¸²æŸ“åŒºåŸŸçš„è¾¹ç•Œï¼Œä¸ºäº†ä¾¿äºç†è§£ï¼Œæœ¬æ–‡å°†å…¶ç§°ä¸ºç”»å¸ƒã€‚æˆ‘è¿™å°æ‰‹æœºæ˜¯ 1080P çš„åˆ†è¾¨ç‡ï¼Œdensity = 3ï¼ŒscaledWidth = 2250ï¼ŒscaledHeight = 4002ï¼Œç°åœ¨ç¼©æ”¾åçš„ç”»å¸ƒå®½é«˜æ¯”æ‰‹æœºå±å¹•å¤§äº†å¤ªå¤šï¼Œå¦‚æœåŠ¨ç”»åœ¨è¿™ç§å°ºå¯¸ä¸‹è¿›è¡Œæ¸²æŸ“è‚¯å®šä¸è¡Œã€‚æ‰€ä»¥ LottieAnimationView åŠ è½½ Composition æ—¶åˆ¤æ–­äº†ç”»å¸ƒçš„å®½é«˜å¦‚æœå¤§äºæ‰‹æœºå±å¹•çš„å®½é«˜å°±è¿›è¡Œç­‰æ¯”ä¾‹ç¼©å°ï¼š

```java
public void setComposition(@NonNull LottieComposition composition) {
    if (L.DBG) {
      Log.v(TAG, "Set Composition \n" + composition);
    }
    lottieDrawable.setCallback(this);

    boolean isNewComposition = lottieDrawable.setComposition(composition);
    if (!isNewComposition) {
      // We can avoid re-setting the drawable, and invalidating the view, since the composition
      // hasn't changed.
      return;
    }
    //é‡ç‚¹åœ¨è¿™é‡Œï¼Œæ ¹æ®å±å¹•å®½é«˜å¯¹ç”»å¸ƒè¿›è¡Œç­‰æ¯”ä¾‹ç¼©æ”¾
    int screenWidth = Utils.getScreenWidth(getContext());
    int screenHeight = Utils.getScreenHeight(getContext());
    int compWidth = composition.getBounds().width();
    int compHeight = composition.getBounds().height();
    //å¦‚æœç”»å¸ƒçš„å®½é«˜å¤§äºå±å¹•å®½é«˜ï¼Œè®¡ç®—ç¼©æ”¾æ¯”
    if (compWidth > screenWidth ||
        compHeight > screenHeight) {
      float xScale = screenWidth / (float) compWidth;
      float yScale = screenHeight / (float) compHeight;
      //æŒ‰æ¯”ä¾‹ç¼©å°
      setScale(Math.min(xScale, yScale));
      Log.w(L.TAG, String.format(
          "Composition larger than the screen %dx%d vs %dx%d. Scaling down.",
          compWidth, compHeight, screenWidth, screenHeight));
    }


    // If you set a different composition on the view, the bounds will not update unless
    // the drawable is different than the original.
    setImageDrawable(null);
    setImageDrawable(lottieDrawable);

    this.composition = composition;

    requestLayout();
}
```

è®¡ç®—å‡ºå®½å’Œé«˜çš„ç¼©æ”¾æ¯”åï¼Œä¸ºäº†è®©ç”»å¸ƒå°äºå±å¹•ï¼Œæ‰€ä»¥å–è¾ƒå°çš„ä¸€ä¸ªæ¯”ä¾‹ï¼Œè°ƒç”¨ setScale æ–¹æ³•å°†ç¼©æ”¾æ¯”è®¾ç½®åˆ° lottieDrawable ä¸Šï¼š

```java
public void setScale(float scale) {
    lottieDrawable.setScale(scale);
    if (getDrawable() == lottieDrawable) {
      setImageDrawable(null);
      setImageDrawable(lottieDrawable);
    }
}
```

lottieDrawable çš„ setScale æ–¹æ³•ä¿å­˜äº†ç¼©æ”¾æ¯”ï¼Œå¹¶ä¸”æ›´æ–°äº†ç»˜åˆ¶çš„çŸ©å½¢èŒƒå›´ï¼š

```java
public void setScale(float scale) {
    this.scale = scale;
    updateBounds();
}
```

è¿™é‡Œå¯ä»¥çœ‹åˆ°çŸ©å½¢çš„èŒƒå›´æ˜¯æ ¹æ®ç”»å¸ƒçš„å®½é«˜è¿›è¡Œäº†ç­‰æ¯”ä¾‹çš„ç¼©æ”¾

```java
private void updateBounds() {
    if (composition == null) {
      return;
    }
    setBounds(0, 0, (int) (composition.getBounds().width() * scale),
        (int) (composition.getBounds().height() * scale));
}
```

ç°åœ¨ç”»å¸ƒè¢«ç¼©æ”¾äº†ï¼Œç„¶è€ŒèƒŒæ™¯å›¾å‘¢ï¼Ÿæ¥çœ‹ä¸€ä¸‹ lottieDrawable çš„ç»˜åˆ¶ä»£ç ï¼š

```java
public void draw(@NonNull Canvas canvas) {
    if (compositionLayer == null) {
      return;
    }
    matrix.reset();
    matrix.preScale(scale, scale);
    compositionLayer.draw(canvas, matrix, alpha);
  }
```

lottieDrawable åœ¨ç»˜åˆ¶çš„æ—¶å€™å¯¹ matrix è®¾ç½®äº†ç¼©æ”¾æ¯”ï¼Œç„¶åè°ƒç”¨äº† compositionLayer å»è¿›è¡Œå…·ä½“çš„ç»˜åˆ¶ã€‚è¿™ä¸ª compositionLayer å°±æ˜¯æ‰€æœ‰å›¾å±‚çš„ä¸€ä¸ªç»„åˆï¼Œå®ƒæœ‰ä¸€ä¸ª`List<BaseLayer> layers`å±æ€§ï¼Œ è¿™ä¸ªå±æ€§å°±æ˜¯ json æ–‡ä»¶é‡Œé¢çš„`layers`èŠ‚ç‚¹è§£æå‡ºæ¥çš„å›¾å±‚åˆ—è¡¨ï¼Œæ¯ä¸ªå›¾å±‚ä¸­é—´è¿˜åŒ…å«ä¸€äº›å±æ€§åŠ¨ç”»ã€‚`compositionLayer.draw(canvas, matrix, alpha)`æ–¹æ³•ä¸­ä¸»è¦è°ƒç”¨äº† drawLayer æŠ½è±¡æ–¹æ³•ç”±å›¾å±‚çš„å…·ä½“å®ç°ç±»æ‰§è¡Œç»˜åˆ¶ï¼š

```java
void drawLayer(Canvas canvas, Matrix parentMatrix, int parentAlpha) {
    for (int i = layers.size() - 1; i >= 0 ; i--) {
      layers.get(i).draw(canvas, parentMatrix, parentAlpha);
    }
}
```

å¯ä»¥çœ‹åˆ° CompositionLayer ç±»çš„ drawLayer æ–¹æ³•éå† layers é›†åˆè¿›è¡Œå¾ªç¯ç»˜åˆ¶ï¼Œè¿™é‡Œæ˜¯ä½¿ç”¨å›¾ç‰‡æ–‡ä»¶åšçš„åŠ¨ç”»ï¼Œå¯¹åº”çš„ Layer å®ç°ç±»ä¸º ImageLayerã€‚ çœ‹ä¸‹ ImageLayer çš„ç»˜åˆ¶æ–¹æ³•ï¼š

```java
public void drawLayer(@NonNull Canvas canvas, Matrix parentMatrix, int parentAlpha) {
    Bitmap bitmap = getBitmap();
    if (bitmap == null) {
      return;
    }
    paint.setAlpha(parentAlpha);
    canvas.save();
    canvas.concat(parentMatrix);
    src.set(0, 0, bitmap.getWidth(), bitmap.getHeight());
    dst.set(0, 0, (int) (bitmap.getWidth() * density), (int) (bitmap.getHeight() * density));
    canvas.drawBitmap(bitmap, src, dst , paint);
    canvas.restore();
}
```

getBitmap() æ–¹æ³•ä¼šè°ƒç”¨åˆ°ä¸€å¼€å§‹è®¾ç½®çš„ä»£ç†ç±» ImageAssetDelegate ï¼Œä» SD å¡åŠ è½½å›¾ç‰‡ã€‚  

ä»£ç ä¸­è°ƒç”¨äº† canvas çš„`save`ã€`restore`æ–¹æ³•æ¥è¿›è¡Œå›¾å±‚çš„å åŠ ç»˜åˆ¶ï¼Œä» lottieDrawable çš„`draw`æ–¹æ³•ä¼ é€’ä¸‹æ¥çš„`matrix`ç”¨åˆ°äº†`concat`æ–¹æ³•ä¸Šï¼Œå¯¹ bitmap è¿›è¡Œäº†ç­‰æ¯”ç¼©æ”¾ã€‚

æ•´ä¸ªæµç¨‹è·‘ä¸‹æ¥ï¼ŒLottie åº“çš„åŠ¨ç”»æ¸²æŸ“æœºåˆ¶å·²ç»åŸºæœ¬äº†è§£ï¼ŒèƒŒæ™¯å›¾æ²¡æœ‰å…¨å±å±•ç¤ºçš„åŸå› å¦‚ä¸‹ï¼š

**èƒŒæ™¯å›¾çš„é•¿å®½æ¯”æ˜¯ 16 : 9ï¼Œæ‰‹æœºå±å¹•çš„é•¿å®½æ¯”ä¹Ÿæ˜¯ 16 : 9ï¼Œä½†æ˜¯å› ä¸ºåº•éƒ¨çš„è™šæ‹ŸæŒ‰é”®å äº†ä¸€éƒ¨åˆ†çš„é«˜åº¦ï¼Œå±å¹•å¯ç”¨ç©ºé—´çš„é•¿å®½æ¯”å¤§çº¦ä¸º 3 : 2ï¼Œæ‰€ä»¥å¯¼è‡´èƒŒæ™¯å›¾ä¸èƒ½é“ºæ»¡å±å¹•**

## å…¨å±é€‚é…

åŠ¨ç”»ä¸èƒ½å…¨å±æœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯æ‰‹æœºé•¿å®½æ¯”å’Œç”»å¸ƒçš„é•¿å®½æ¯”æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯çŠ¶æ€æ ã€å¯¼èˆªæ å äº†å±å¹•ä¸€éƒ¨åˆ†ç©ºé—´å¯¼è‡´ä¸èƒ½å…¨å±ï¼Œä½¿ç”¨æ–¹æ¡ˆä¸€å¯ä»¥è§£å†³é—®é¢˜ã€‚è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯æ‰‹æœºå±å¹•é•¿å®½æ¯”å’Œç”»å¸ƒçš„é•¿å®½æ¯”å°±æ˜¯ä¸ä¸€æ ·ï¼Œæ¯•ç«Ÿ Android æœºå‹è¿™ä¹ˆå¤šï¼Œæœ‰å‡ å°å¥‡è‘©æ‰‹æœºå¾ˆæ­£å¸¸ï¼Œé‚£ä¹ˆä½¿ç”¨æ–¹æ¡ˆäºŒå¯ä»¥å®ç°å…¨å±ã€‚

### æ–¹æ¡ˆä¸€

åœ¨æ‰§è¡ŒåŠ¨ç”»çš„ç•Œé¢éšè—è™šæ‹ŸæŒ‰é”®ï¼Œæˆ–è€…å°†è™šæ‹ŸæŒ‰é”®è®¾ç½®ä¸ºé€æ˜æµ®åœ¨å¸ƒå±€ä¸Šé¢ï¼Œè¿™æ ·å±å¹•çš„é•¿å®½æ¯”å’Œç”»å¸ƒçš„é•¿å®½æ¯”ä¸€æ ·å°±æ²¡æœ‰é—®é¢˜ã€‚ç›®å‰å¸‚é¢ä¸Šçš„æ‰‹æœºåŸºæœ¬ä¸Šéƒ½æ˜¯ 720Pã€1080Pã€2K ç­‰åˆ†è¾¨ç‡ï¼Œè¿™äº›åˆ†è¾¨ç‡éƒ½æ˜¯ 16 : 9 çš„å°ºå¯¸ã€‚

çŠ¶æ€æ å’Œè™šæ‹ŸæŒ‰é”®é€æ˜æ‚¬æµ®åœ¨å¸ƒå±€ä¸Šé¢ï¼Œè®¾ç½®æ ·å¼ï¼š

```xml
<style name="Theme">
        <item name="android:windowTranslucentStatus">true</item>
        <item name="android:windowTranslucentNavigation">true</item>
</style>
```

éšè—è™šæ‹ŸæŒ‰é”®é€šè¿‡ä»£ç è®¾ç½®ï¼š

```java
Window window = getWindow();
int visibility = View.SYSTEM_UI_FLAG_HIDE_NAVIGATION |
                View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN |
                View.SYSTEM_UI_FLAG_LAYOUT_STABLE |
                View.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION;
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) {
    window.clearFlags(WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS);
    window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS);
    window.setStatusBarColor(ContextCompat
                    .getColor(getActivity(), android.R.color.transparent));
    visibility |= View.SYSTEM_UI_FLAG_IMMERSIVE_STICKY;
} else if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.KITKAT) {
    window.addFlags(WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS);
    visibility |= View.SYSTEM_UI_FLAG_IMMERSIVE_STICKY;
}
window.getDecorView().setSystemUiVisibility(visibility);
```

ä½¿ç”¨ä»£ç éšè—è™šæ‹ŸæŒ‰é”®éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼š**ç•Œé¢çš„åˆ‡æ¢ä¼šå¯¼è‡´ setSystemUiVisibility() çš„è®¾ç½®è¢«æ¸…ç©ºï¼Œæœ€å¥½æ˜¯åœ¨ onResume() æˆ–è€… onWindowFocusChanged() æ–¹æ³•ä¸­è¿›è¡Œè®¾ç½®ã€‚**

### æ–¹æ¡ˆäºŒ

å¦‚æœè¦é€‚é…å…¶ä»–é•¿å®½æ¯”çš„å±å¹•ï¼Œå’‹åŠå‘¢ï¼Ÿä¸¤è¡Œä»£ç è§£å†³é—®é¢˜ï¼Œåªä¸è¿‡å›¾ç‰‡æœ‰ä¸€éƒ¨åˆ†ä¼šè¢«è£å‰ªã€‚è®¾ç½®æ§ä»¶çš„å®½é«˜ä¸º`match_parent`ï¼Œè®¾ç½®`android:scaleType`ä¸º`centerCrop`

```xml
<com.airbnb.lottie.LottieAnimationView
        android:id="@+id/lottieAnimationView"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:scaleType="centerCrop"/>
```

## æ€»ç»“

Lottie å‘å¸ƒæ‰å‡ ä¸ªæœˆï¼Œå¾ˆå¤šåŠŸèƒ½è¿˜ä¸å¤Ÿå®Œå–„ï¼Œç¼“å­˜æœºåˆ¶ä¹Ÿæ¯”è¾ƒå¼±ï¼Œåƒè¿™ç§ä» SD å¡åŠ¨æ€åŠ è½½çš„æ–¹å¼ï¼Œéœ€è¦è‡ªå·±å»å®ç°ç¼“å­˜é€»è¾‘ã€‚ä½†æ˜¯è¿™ç‚¹å°ç‘•ç–µæ©ç›–ä¸äº†ç‰›é€¼çš„äº‹å®ï¼Œå°±ç›®å‰è¿™ä¸ªéœ€æ±‚æ¥è¯´ï¼Œå·²ç»å¤§å¤§çš„é™ä½äº†å¼€å‘æˆæœ¬ã€‚åªä¸è¿‡è®¾è®¡å¸ˆä»¬éœ€è¦å¥½å¥½ç»ƒç»ƒ AE äº†ï¼ŒåŠ¨ç”»ç‚«ä¸ç‚«å°±çœ‹è®¾è®¡å¸ˆç»™ä¸ç»™åŠ›å•¦ğŸ˜†ğŸ˜†

æœ¬æ–‡æ˜¯ä½œè€…çš„å¤„å¥³ä½œï¼Œå¦‚æœå¯¹å¤§å®¶æœ‰å¸®åŠ©ï¼Œå¸Œæœ›å¤§å®¶å¤šå¤šæ”¯æŒï¼Œç»™äºˆä½œè€…æ›´å¤šçš„åˆ›ä½œåŠ¨åŠ›ï¼Œæä¾›æ›´å¥½çš„ä½œå“ç»™å¤§å®¶ã€‚  
<center>æ¬¢è¿å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ï¼š**å¤§è„‘å¥½é¥¿**ï¼Œæ›´å¤šå¹²è´§ç­‰ä½ æ¥å°</center>
{% qnimg wx_qrcode.png title:å…¬ä¼—å·ï¼šå¤§è„‘å¥½é¥¿  %}
